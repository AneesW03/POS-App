<!-- Invoice Management Page -->
<ion-header [translucent]="true" class="small-header">
    <ion-toolbar>
      <ion-title>Invoice Management</ion-title>
    </ion-toolbar>
</ion-header>
  
    <ion-content class="ion-padding">
        <!-- Summary Bar -->
        <ion-card>
          <ion-card-content>
            <ion-grid>
              <ion-row>
                <ion-col class="summary-item">
                  <ion-badge color="success">Delivered: {{ deliveredCount }}</ion-badge>
                </ion-col>
                <ion-col class="summary-item">
                  <ion-badge color="warning">To be Delivered: {{ undeliveredCount }}</ion-badge>
                </ion-col>
                <ion-col class="summary-item">
                    <ion-badge color="warning">Returns: {{ returnsCount }}</ion-badge>
                  </ion-col>
              </ion-row>
            </ion-grid>
          </ion-card-content>
    </ion-card>
  
    <!-- Search Bar with Dropdown -->
    <div class="search-container">
        <ion-searchbar [(ngModel)]="searchQuery" (ionInput)="filterInvoices($event)"></ion-searchbar>
        <ion-button fill="clear" id="filter-button" class="small-button" (click)="toggleDropDown()">
        <ion-icon name="chevron-down"></ion-icon>
      </ion-button>
    </div>
    <ion-list *ngIf="!isDropdownHidden">
      <ion-item button>Search by Newest</ion-item>
      <ion-item button>Filter by Oldest</ion-item>
      <ion-item button>Show Undelivered</ion-item>
    </ion-list>
  
    <!-- Invoice List -->
    <ion-list>
        <ion-card class="invoice-card" *ngFor="let invoice of filteredInvoices" (click)="openInvoiceDetails(invoice)">
          <ion-card-content>
            <h3>{{ invoice.company }}</h3>
            <ion-grid>
              <ion-row>
                <ion-col><b>Amt</b><br>${{ invoice.totalItems }}</ion-col>
                <ion-col><b>No</b><br>{{ invoice.invoiceNo }}</ion-col>
                <ion-col><b>Date</b><br>{{ invoice.invoiceDate }}</ion-col>
              </ion-row>
            </ion-grid>
            <ion-button [color]="invoice.generate === 'Y' ? 'success' : 'warning'">
              {{ invoice.generate }}
            </ion-button>
          </ion-card-content>
        </ion-card>
    </ion-list>
      
  </ion-content>
  
  <!-- Bottom Navigation -->
  <ion-footer>
    <div class="bottom-navbar">
      <ion-tab-bar>
        <ion-tab-button>
          <ion-icon name="person-outline"></ion-icon>
        </ion-tab-button>
        <ion-tab-button>
          <ion-icon name="refresh-outline"></ion-icon>
        </ion-tab-button>
        <ion-tab-button>
          <ion-icon name="home-outline"></ion-icon>
        </ion-tab-button>
        <ion-tab-button>
          <ion-icon name="cloud-upload-outline"></ion-icon>
        </ion-tab-button>
        <ion-tab-button>
          <ion-icon name="settings-outline"></ion-icon>
        </ion-tab-button>
      </ion-tab-bar>
    </div>
  </ion-footer>

  <script>
document.addEventListener("DOMContentLoaded", function () {
  const filterButton = document.getElementById("filter-button");
  const dropdown = document.getElementById("filter-dropdown");

  if (!filterButton || !dropdown) {
    console.error("Dropdown elements not found!");
    return;
  }

  filterButton.addEventListener("click", function (event) {
    dropdown.classList.toggle("show");
    event.stopPropagation(); 
  });

  
  document.addEventListener("click", function (event) {
    if (!dropdown.contains(event.target) && !filterButton.contains(event.target)) {
      dropdown.classList.remove("show");
    }
  });

  
  dropdown.querySelectorAll("ion-item").forEach((item) => {
    item.addEventListener("click", function () {
      dropdown.classList.remove("show");
    });
  });
});

  </script>